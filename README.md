# Gator

Gator is a command-line RSS feed aggregator written in Go. It allows you to manage RSS feeds, follow/unfollow feeds, and browse posts from your subscribed feeds in your terminal.

## Features

- User management (register, login, list users)
- RSS feed management (add, list, follow, unfollow feeds)
- Automatic feed aggregation and post collection
- Browse posts from followed feeds
- PostgreSQL database storage
- JSON-based configuration

## Dependencies

### Runtime Dependencies
- **Go**: Version 1.24.0 or higher
- **PostgreSQL**: Database server for storing feeds and posts

### Go Modules
- `github.com/lib/pq`: PostgreSQL driver for Go
- `github.com/google/uuid`: UUID generation library

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/jennygaz/gator.git
   cd gator
   ```

2. Install dependencies:
   ```bash
   go mod tidy
   ```

3. Set up PostgreSQL database and run migrations:
   ```bash
   # Create a PostgreSQL database
   # Run the SQL migration files in sql/schema/ in order
   ```

4. Build the application:
   ```bash
   go build -o gator
   ```

## Configuration

Gator uses a configuration file located at `~/.gatorconfig.json`. The configuration file should contain:

```json
{
  "db_url": "postgres://username:password@localhost/gator?sslmode=disable",
  "current_user_name": ""
}
```

### Configuration Fields
- `db_url`: PostgreSQL connection string
- `current_user_name`: Currently logged-in user (set automatically)

## Usage

### Basic Commands

```bash
# Register a new user
./gator register <username>

# Login as a user
./gator login <username>

# List all users
./gator users

# Reset the database (removes all data)
./gator reset
```

### Feed Management

```bash
# Add a new RSS feed
./gator addfeed <feed_name> <feed_url>

# List all available feeds
./gator feeds

# Follow a feed
./gator follow <feed_url>

# List feeds you're following
./gator following

# Unfollow a feed
./gator unfollow <feed_url>
```

### Content Management

```bash
# Start feed aggregation (fetches latest posts)
./gator agg <time_between_requests>

# Browse posts from followed feeds
./gator browse [limit]
```

## Database Schema

The application uses the following main tables:
- `users`: User accounts
- `feeds`: RSS feed information
- `feed_follows`: User feed subscriptions
- `posts`: Aggregated feed posts

## Development

### Project Structure

```
gator/
├── main.go              # Application entry point
├── commands.go          # Command routing system
├── handler_*.go         # Command handlers
├── rss_feed.go         # RSS parsing functionality
├── internal/
│   ├── config/         # Configuration management
│   └── database/       # Database queries (generated by sqlc)
└── sql/
    ├── queries/        # SQL query definitions
    └── schema/         # Database migration files
```

### Code Generation

This project uses `sqlc` for generating type-safe Go code from SQL queries. The configuration is in `sqlc.yaml`.

## Examples

### Basic Workflow

1. Register and login:
   ```bash
   ./gator register alice
   ./gator login alice
   ```

2. Add and follow feeds:
   ```bash
   ./gator addfeed "TechCrunch" "https://techcrunch.com/feed/"
   ./gator follow "https://techcrunch.com/feed/"
   ```

3. Start aggregation and browse posts:
   ```bash
   ./gator agg 60s  # Fetch new posts every 60 seconds
   # In another terminal:
   ./gator browse 10  # Show latest 10 posts
   ```

## Error Handling

- The application will exit with an error message if:
  - Database connection fails
  - Configuration file is invalid or missing
  - Invalid command or arguments are provided
  - User is not logged in for protected commands

## Contributing

This project follows standard Go conventions. Ensure your code:
- Passes `go vet` and `go fmt`
- Includes appropriate error handling
- Follows the existing code structure

## License

[Add your license information here]